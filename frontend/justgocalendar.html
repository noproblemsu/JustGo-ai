<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë‚ ì§œ ì„ íƒ</title>

  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />

  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      font-family: 'Istok Web', sans-serif;
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      color: #000000;
    }
    * { box-sizing: border-box; }
    a { text-decoration: none; color: inherit; }
/*** @ì–´ì©Œêµ¬ë„ ì§€ì›€*/
    /* ===== ì—¬í–‰ì§€ ì„ íƒ í˜ì´ì§€ì™€ ë™ì¼í•œ ì»¨í…Œì´ë„ˆ ê·œê²© ===== */
  /************************************************************/
    .container {
  position: relative;        /* ì ˆëŒ€ì¢Œí‘œ ê¸°ì¤€ */
  background-color: #ffffff;
  width: 393px;              /* ê³ ì • */
  height: 787px;             /* ê³ ì • (ì›í•˜ë©´ 680~820ë¡œ ì¡°ì ˆ) */
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  padding: 72px 16px 43px;
}
/******************************************************/

    .title {
      font-weight: 700;
      font-size: 30px;
      line-height: 1.44;
      color: #000000;
      margin: 0;
      text-align: left;
    }

    /* ===== í˜ì´ì§€ ì„¹ì…˜ êµ¬ì¡° ===== */
    #date-section { width: 100%; display: flex; justify-content: center; }
    #date-section .page-header { flex-shrink: 0; }

    /* ë³¸ë¬¸ì€ ê°™ì€ ìƒë‹¨ ê°„ê²©(46px) + ê°€ìš´ë° ë°°ì¹˜ */
    #date-section .content {
      margin-top: -300px;     /* ì—¬í–‰ì§€ í˜ì´ì§€ì™€ ë™ì¼ */
      flex-grow: 1;
      display: grid;
      place-items: center;  /* ìº˜ë¦°ë” ì¤‘ì•™ */
    }

    /* í‘¸í„°ëŠ” ë™ì¼í•˜ê²Œ ì•„ë˜ë¡œ ë¶™ê³  ê°€ìš´ë° ì •ë ¬ + ì—¬ìœ  ì—¬ë°± */
    #date-section .page-footer {
      margin-top: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      flex-shrink: 0;
      margin-bottom: 72px;  /* ì—¬í–‰ì§€ í˜ì´ì§€ footerì™€ ë™ì¼ */
    }

    .btn-primary {
      background-color: #0059ff;
      border-radius: 8px;
      color: #ffffff;
      font-weight: 700;
      font-size: 18px;
      height: 55px;
      width: 100%;
      border: none;
      cursor: pointer;
    }
    .btn-primary:hover { background-color: #0045c7; }
    .skip-link { font-size: 12px; margin-top: 12px; }

    /* ===== Flatpickr ë ˆì´ì•„ì›ƒì„ ì»¨í…Œì´ë„ˆì— ë§ì¶¤ ===== */
    #calendar { width: fit-content; margin: 0 auto; }
    .flatpickr-calendar.inline {
      width: auto !important;
      max-width: 100%;
      margin: 0 auto;
      font-size: 19px; /* ì‚´ì§ í‚¤ì›€ */
    }
    .flatpickr-day { height: 41px; line-height: 41px; max-width: 41px; }

   
   /* ğŸ”¼ Flatpickr í—¤ë”(ë…„ë„/ì›”) ì‚´ì§ í‚¤ì›€ */
.flatpickr-months .flatpickr-current-month { 
  font-size: 18px !important;
  line-height: 1.25;
}

.flatpickr-current-month .cur-month {
  font-size: 18px !important;
}

.flatpickr-current-month input.cur-year {
  font-size: 18px !important;
  height: 1.4em;    /* ì„¸ë¡œ ì •ë ¬ ë³´ì • */
  padding: 0 2px;   /* ì¢Œìš° ì—¬ë°± ì‚´ì§ */
}

.flatpickr-monthDropdown-months {
  font-size: 18px !important;
}
/**************************************************************/
/* ì™„ë£Œ ë²„íŠ¼: ì ˆëŒ€ì¢Œí‘œ + ê¸€ì ì •ì¤‘ì•™ */
#date-section .btn-primary {
  position: absolute;
  left: 16px;
  top: 652.5px;     /* ë” ë‚´ë¦¬ê³  ì‹¶ìœ¼ë©´ í‚¤ì›Œë„ ë¨ (ì˜ˆ: 670px) */
  width: 361px;     /* 393 - 16*2 */
  height: 55px;

  display: flex;            /* ê¸€ì ê°€ë¡œ/ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
  justify-content: center;
  align-items: center;
}

/* "ë‹¤ìŒì— í•˜ê¸°" ë§í¬: ê°€ë¡œ ì •í™•íˆ ì¤‘ì•™ */
#date-section .skip-link {
  position: absolute;
  top: 707.5px;     /* ì™„ë£Œ ë²„íŠ¼ê³¼ ê°„ê²© ë§ì¶¤. í•„ìš”ì‹œ ì¡°ì ˆ */
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
}
/*******************************************************/
  </style>
</head>
<body>
  <section id="date-section">
    <div class="container">
      <header class="page-header">
        <h1 class="title">ì–¸ì œ ë– ë‚˜ì‹œë‚˜ìš”?</h1>
      </header>

      <main class="content">
        <div id="calendar"></div>
      </main>

      <footer class="page-footer">
        <button class="btn-primary" id="submit-btn">ì™„ë£Œ</button>
        <a href="#" class="skip-link" id="skip-link">ë‹¤ìŒì— í•˜ê¸°</a>
      </footer>
    </div>
  </section>

  <!-- Flatpickr JS & í•œêµ­ì–´ ë¡œì¼€ì¼ -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>

 <script>
  // ---- ìœ í‹¸: ë¡œì»¬ yyyy-mm-dd ----
  function fmtYmdLocal(d){
    const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), day=String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${day}`;
  }
  function atNoon(d){ return new Date(d.getFullYear(), d.getMonth(), d.getDate(), 12, 0, 0, 0); }

  const params   = new URLSearchParams(location.search);
  const fromPage = params.get("from");

  // âœ… ì €ì¥ëœ ë‚ ì§œ(ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜´) â€” ì œì¶œ í•¸ë“¤ëŸ¬ì—ì„œ fallbackìœ¼ë¡œë§Œ ì‚¬ìš©
  const savedDates = JSON.parse(localStorage.getItem("selectedDates") || "[]");

  // âœ… flatpickrëŠ” í•œ ë²ˆë§Œ ì´ˆê¸°í™” + defaultDate(ì¡°ê±´ë¶€)
  const fp = flatpickr("#calendar", {
    mode: "range",
    dateFormat: "Y-m-d",
    minDate: "today",
    inline: true,
    locale: "ko",
    defaultDate: (fromPage === "justgoset.html" && savedDates.length === 2) ? savedDates : null
    // onChange ì—†ì–´ë„ ë¨. ì œì¶œ ì‹œ fp.selectedDatesì—ì„œ ì§ì ‘ ì½ìŒ
  });

  // âœ… ì™„ë£Œ
  document.getElementById("submit-btn").addEventListener("click", () => {
    // í•­ìƒ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ìµœì‹  ì„ íƒê°’ì„ ì½ìŒ
    const picked = fp.selectedDates.map(fmtYmdLocal);

    // ìƒˆ ì„ íƒê°’ì´ 2ê°œë©´ ê·¸ê²ƒì„, ì•„ë‹ˆë©´ (setì—ì„œ ë³µê·€ ì‹œ) savedDatesë¥¼ ì‚¬ìš©
    const toSave =
      (picked.length === 2) ? picked :
      ((fromPage === "justgoset.html" && savedDates.length === 2) ? savedDates : []);

    if (toSave.length !== 2) {
      alert("ì‹œì‘ê³¼ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.");
      return;
    }

    // ì¼ìˆ˜ ê³„ì‚°(ë¡œì»¬ ì •ì˜¤ ê¸°ì¤€)
    const [sy, sm, sd] = toSave[0].split("-").map(Number);
    const [ey, em, ed] = toSave[1].split("-").map(Number);
    const start = atNoon(new Date(sy, sm-1, sd));
    const end   = atNoon(new Date(ey, em-1, ed));
    const days  = Math.round((end - start)/86400000) + 1;

    localStorage.setItem("selectedDates", JSON.stringify(toSave));
    localStorage.setItem("travelDays", String(days));

    location.href = (fromPage === "justgoset.html") ? "justgoset.html" : "justgomoney.html";
  });

  // âœ… ë‹¤ìŒì— í•˜ê¸°
  document.getElementById("skip-link").addEventListener("click", (e) => {
    e.preventDefault();
    if (fromPage === "justgoset.html") {
      // ê°’ ìœ ì§€
      localStorage.setItem("skipRecommendation", "true");
      location.href = "justgoset.html";
    } else {
      // ê°’ ì‚­ì œ
      localStorage.removeItem("selectedDates");
      localStorage.setItem("skipRecommendation", "true");
      location.href = "justgomoney.html";
    }
  });
</script>

</body>
</html>
